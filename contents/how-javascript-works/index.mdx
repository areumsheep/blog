---
slug: 'how-javascript-works'
title: 'ğŸŒŸ ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ì–´ë–»ê²Œ ë™ì‘í•˜ë‚˜ìš”?'
description: 'ì´ë²¤íŠ¸ ë£¨í”„, ë™ì‹œì„±, ì½œìŠ¤íƒ, ì„¸ ê°œì˜ í, Web API ë“±ì˜ ê°œë…ì„ ì•Œì•„ë´…ì‹œë‹¤!'
tags: ['JavaScript', 'Browser']
createdAt: '2023-02-26 10:36:40'
updatedAt: ''
---

> [How Does JavaScript Even Work? Things Which 90% of JavaScript Developers Don't Know! (Part 1)](https://lightmap.dev/how-does-javascript-even-work-1#heading-timeout-sort),
> [How Does JavaScript Even Work? Things Which 90% of JavaScript Developers Don't Know! (Part 2)](https://lightmap.dev/how-does-javascript-even-work-part-2) ê¸€ì„ ì°¸ê³ í•˜ì—¬ ì‘ì„±ë˜ì—ˆìœ¼ë‚˜, ì˜¤ì—­ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

# JavaScriptì™€ ì‹±ê¸€ ìŠ¤ë ˆë“œ

> **í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œ == í•˜ë‚˜ì˜ í˜¸ì¶œ ìŠ¤íƒ == í•œ ë²ˆì— í•˜ë‚˜ì”©**

ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹±ê¸€ ìŠ¤ë ˆë“œë¼ëŠ” ê²ƒì€ ì—”ì§„ë§ˆë‹¤ ë‹¨ í•˜ë‚˜ì˜ í˜¸ì¶œ ìŠ¤íƒ(call stack)ì´ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê·¸ë ‡ê¸°ì— ëª¨ë“  ì‹¤í–‰ì€ í•˜ë‚˜ì”© ìˆœì°¨ì ìœ¼ë¡œ ë°œìƒí•©ë‹ˆë‹¤.
ì¦‰, ì½”ë“œë“¤ì€ í˜„ì¬ì˜ ì½”ë“œê°€ ì‹¤í–‰ë˜ê¸¸ ê¸°ë‹¤ë ¤ì•¼ í•©ë‹ˆë‹¤.

> ğŸ¤” **ê·¸ëŸ¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ì¤‘ ìŠ¤ë ˆë“œê°€ ë¶ˆê°€ëŠ¥í•œê°€ìš”?**  
> ì•„ë‹™ë‹ˆë‹¤! `Worker Thread` ë¥¼ ì´ìš©í•˜ì—¬ ë‹¤ì¤‘ ìŠ¤ë ˆë“œì™€ ë¹„ìŠ·í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> **ê·¸ë ‡ë‹¤ë©´ ì™œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹±ê¸€ ìŠ¤ë ˆë“œ ì–¸ì–´ë¼ê³  ë¶€ë¥¼ê¹Œìš”?**  
> ë¸Œë¼ìš°ì €ì˜ V8 ê°™ì€ ì—”ì§„ì—ëŠ” í•˜ë‚˜ì˜ í˜¸ì¶œ ìŠ¤íƒë§Œ ì¡´ì¬í•˜ê¸°ì— JSë¥¼ ì‹±ê¸€ ìŠ¤ë ˆë“œë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

# ê°„ë‹¨í•œ ê°œë… ì¡ê¸°

## ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„

JS ì—”ì§„ì˜ ê°€ì¥ ëŒ€í‘œì ì¸ ì˜ˆì‹œëŠ” Googleì˜ V8 ì—”ì§„ì…ë‹ˆë‹¤. V8 ì—”ì§„ì€ í¬ë¡¬ê³¼ Node.jsì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.
ì—”ì§„ì„ ê°„ë‹¨í•˜ê²Œ í‘œí˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/2dbcee43-e812-4715-ae9f-cd7fa51faa85/image.png)

ì—”ì§„ì€ ë‘ ê°€ì§€ì˜ ëŒ€í‘œ ìš”ì†Œë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.

- Memory Heap: ë©”ëª¨ë¦¬ í• ë‹¹ì´ ì¼ì–´ë‚˜ëŠ” ê³³
- Call Stack: ì½”ë“œ ì‹¤í–‰ì— ë”°ë¼ í˜¸ì¶œ ìŠ¤íƒì´ ìŒ“ì´ëŠ” ê³³

## ëŸ°íƒ€ì„(Runtime)

ê±°ì˜ ëª¨ë“  JavaScript ê°œë°œìë“¤ì€ setTimeout ê°™ì€ ë¸Œë¼ìš°ì € ë‚´ì¥ APIë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
í•´ë‹¹ APIëŠ” JS ì—”ì§„ì—ì„œ ì œê³µí•˜ëŠ” ê²ƒë„ ì•„ë‹Œë° ì–´ë–»ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê±¸ê¹Œìš”?

í˜„ì‹¤ì€ ì¡°ê¸ˆ ë³µì¡í•©ë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/f0c09804-2852-4f87-832d-02d6151acd0f/image.png)

ë¸Œë¼ìš°ì €ì—ëŠ” JS ì—”ì§„ ì™¸ì—ë„ ë‹¤ì–‘í•œ ìš”ì†Œë“¤ì´ ë§ìŠµë‹ˆë‹¤.

DOM, Ajax, setTimeoutê³¼ ê°™ì´ ë¸Œë¼ìš°ì €ì—ì„œ ì œê³µí•˜ëŠ” APIë“¤ì„ Web APIë¼ê³  í•©ë‹ˆë‹¤.

ê·¸ë¦¼ ì•„ë˜ ìª½ì—” **ì´ë²¤íŠ¸ ë£¨í”„**(event loop)ì™€ **ì½œë°± í**(callback queue)ë„ ìˆìŠµë‹ˆë‹¤.

## í˜¸ì¶œ ìŠ¤íƒ(Call Stack)

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ì‹±ê¸€ ìŠ¤ë ˆë“œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì…ë‹ˆë‹¤.

ì´ ë§ì€ í•˜ë‚˜ì˜ í˜¸ì¶œ ìŠ¤íƒì„ ê°€ì§€ê³  ìˆë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
ë”°ë¼ì„œ í•œ ë²ˆì— í•œ ì‘ì—…ë§Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í˜¸ì¶œ ìŠ¤íƒì€ ê¸°ë³¸ì ìœ¼ë¡œ ìš°ë¦¬ê°€ í”„ë¡œê·¸ë¨ ìƒì—ì„œ ì–´ë””ì— ìˆëŠ”ì§€ë¥¼ ê¸°ë¡í•˜ëŠ” ìë£Œêµ¬ì¡°ì…ë‹ˆë‹¤.

ë§Œì•½ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ë©´, í•´ë‹¹ í•¨ìˆ˜ëŠ” í˜¸ì¶œ ìŠ¤íƒì˜ ìµœìƒë‹¨ì— ì¡´ì¬í•˜ê²Œ ë©ë‹ˆë‹¤.
ë§Œì•½ í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ë©´(ë¦¬í„´ ê°’ì„ ëŒë ¤ì¤€ë‹¤ë©´), ìŠ¤íƒì˜ ìµœìƒë‹¨ì— ì¡´ì¬í•˜ë˜ ê²ƒì´ ì‚¬ë¼ì§€ê²Œ ë©ë‹ˆë‹¤.

ê·¸ê²ƒì´ ìŠ¤íƒì˜ ì—­í• ì…ë‹ˆë‹¤.

ì˜ˆì œ ì½”ë“œë¥¼ ì‚´í´ë´…ì‹œë‹¤.

```jsx
function multiply(x, y) {
  return x * y;
}
function printSquare(x) {
  var s = multiply(x, x);
  console.log(s);
}
printSquare(5);
```

ì—”ì§„ì´ ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•  ë•Œ, í˜¸ì¶œ ìŠ¤íƒì€ ë¹„ì›Œì§‘ë‹ˆë‹¤.
ê·¸ë¦¬ê³  ì•„ë˜ì²˜ëŸ¼ ë³€í•˜ê²Œ ë©ë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/e9ca86ee-9aa1-4c0b-a516-8f3a7f8b4a23/image.png)

í˜¸ì¶œ ìŠ¤íƒì˜ ê° í•­ëª©ì„ **ìŠ¤íƒ í”„ë ˆì„**(Stack Frame)ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

## ë™ì‹œì„± & ì´ë²¤íŠ¸ ë£¨í”„(Event Loop)

í˜¸ì¶œ ìŠ¤íƒì— êµ‰ì¥íˆ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ëŠ” í•¨ìˆ˜ í˜¸ì¶œì´ ìˆë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”?
ì˜ˆë¥¼ ë“¤ë©´ ë¸Œë¼ìš°ì €ì—ì„œ JavaScriptë¥¼ ì‚¬ìš©í•˜ì—¬ ë³µì¡í•œ ì´ë¯¸ì§€ ë³€í™˜ì„ í•˜ëŠ” ê²ƒ ê°™ì€ ìƒí™©ì—ì„œìš”.

_ì´ê²Œ ë¬¸ì œê°€ ìˆë‚˜ìš”?_ ë¼ê³  ìƒê°í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ì´ ë¬¸ì œë¥¼ ë¸Œë¼ìš°ì € ê´€ì ìœ¼ë¡œ ë³´ìë©´ í˜¸ì¶œ ìŠ¤íƒì˜ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ ë¸Œë¼ìš°ì €ëŠ” ì•„ë¬´ ì‘ì—…ë„ í•˜ì§€ ëª»í•˜ê³  ê¸°ë‹¤ë ¤ì•¼ í•©ë‹ˆë‹¤.

ë¸Œë¼ìš°ì €ëŠ” ë Œë”ë§ë„ ëª»í•˜ê³  ë‹¤ë¥¸ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ë„ ì—†ìŠµë‹ˆë‹¤. ê·¸ì € ê°‡íŒ ìƒíƒœê°€ ë˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
ë§Œì•½ ë§¤ë„ëŸ½ê³  ìì—°ìŠ¤ëŸ¬ìš´ í™”ë©´ UIë¥¼ ì›í•œë‹¤ë©´ ìœ„ ê²½ìš°ëŠ” ë¬¸ì œê°€ ë©ë‹ˆë‹¤.

ì´ ë¿ë§Œì´ ì•„ë‹™ë‹ˆë‹¤.

ë¸Œë¼ìš°ì €ê°€ í˜¸ì¶œ ìŠ¤íƒì˜ ë§ì€ ì¼ë“¤ì„ ì²˜ë¦¬í•˜ë©´ í™”ë©´ì´ ì˜¤ë«ë™ì•ˆ ì‘ë‹µí•˜ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤.
ì´ ê²½ìš°ì—ëŠ” ëŒ€ë¶€ë¶„ì˜ ë¸Œë¼ìš°ì €ê°€ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ë¥¼ ë„ìš°ë©° í˜ì´ì§€ë¥¼ ì¢…ë£Œí•  ê²ƒì¸ì§€ ë¬»ìŠµë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/4a9d7f46-24e9-4b4d-b460-7b6336d391d4/image.png)

ì´ ìƒí™©ì€ ì ˆëŒ€ ì´ìƒì ì¸ ì‚¬ìš©ì ê²½í—˜ì„ ê°€ì§ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ í˜ì´ì§€ ë Œë”ë§ ë™ì‘ì„ ë°©í•´í•˜ì§€ ì•Šê³  ë¸Œë¼ìš°ì €ì˜ ì‘ë‹µë„ ëŠì§€ ì•Šìœ¼ë©° ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆì„ê¹Œìš”?

ì •ë‹µì€ **ë¹„ë™ê¸° ì½œë°±**ì…ë‹ˆë‹¤.

ì´ì œëŠ” ìì„¸í•˜ê²Œ ì´ì•¼ê¸°í•´ë´…ì‹œë‹¤!

# ë©”ì¸ ìŠ¤ë ˆë“œì™€ í˜¸ì¶œ ìŠ¤íƒ ìì„¸íˆ ì´í•´í•˜ê¸°

ëª‡ ê°€ì§€ í”„ë¡œê·¸ë¨ì„ í†µí•´ ë©”ì¸ ìŠ¤ë ˆë“œì™€ í˜¸ì¶œ ìŠ¤íƒì˜ ì‹¤í–‰ íë¦„ì„ ì´í•´í•´ë´…ì‹œë‹¤!

## í˜¸ì¶œ ìŠ¤íƒ ì´í•´í•˜ê¸°

```jsx
function bar() {
  console.log('bar');
}
function jazz() {
  console.log('jazz');
  bar();
}
function foo() {
  console.log('foo');
  jazz();
}
const btn = document.getElementById('foo');
btn.addEventListener('click', foo, false);

// Output (ë²„íŠ¼ í´ë¦­ ì‹œ)
// foo
// jazz
// bar
```

1. Global Execution Context(GEC)ê°€ ìƒì„±ë˜ì–´ í˜¸ì¶œ ìŠ¤íƒì— í‘¸ì‹œë©ë‹ˆë‹¤.
2. foo ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
3. foo()ì— ëŒ€í•œ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ìƒì„±ë˜ê³  í˜¸ì¶œ ìŠ¤íƒì— í‘¸ì‹œëœ ë’¤ í•œ ì¤„ì”© ì‹¤í–‰í•©ë‹ˆë‹¤.
4. foo() í•¨ìˆ˜ì—ì„  â€œfooâ€ë¥¼ ì½˜ì†”ì— ì¶œë ¥í•˜ê³  jazz() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
5. jazz()ì— ëŒ€í•œ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ìƒˆë¡œ ìƒì„±ë˜ê³  í˜¸ì¶œ ìŠ¤íƒì˜ ìƒë‹¨ì— í‘¸ì‹œë©ë‹ˆë‹¤.
6. jazz()ëŠ” â€œjazzâ€ë¥¼ ì½˜ì†”ì— ì¶œë ¥í•˜ê³  bar() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
7. bar()ì— ëŒ€í•œ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ìƒˆë¡œ ìƒì„±ë˜ê³  í˜¸ì¶œ ìŠ¤íƒì˜ ìƒë‹¨ì— í‘¸ì‹œë©ë‹ˆë‹¤.
   ê·¸ ì´í›„ â€œbarâ€ê°€ ì½˜ì†”ì— ì¶œë ¥ë©ë‹ˆë‹¤.
8. bar()ê°€ ë¦¬í„´ë˜ë©´ ìŠ¤íƒì—ì„œ ì œê±°(pop)ë©ë‹ˆë‹¤.
9. jazz()ì™€ foo()ëª¨ë‘ ì œê±°ë˜ì–´ ìŠ¤íƒì˜ ë§ˆì§€ë§‰ì— ë„ë‹¬í•˜ê²Œ ë©ë‹ˆë‹¤.
10. í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œë˜ë©´ GECë„ ì œê±°ë˜ê³  í˜¸ì¶œ ìŠ¤íƒì´ ë¹„ì›Œì§‘ë‹ˆë‹¤.

ìœ„ ê³¼ì •ì„ í†µí•´ í•¨ìˆ˜ê°€ í˜¸ì¶œ ìŠ¤íƒì— ì¶”ê°€(push)ë˜ê³ , ì œê±°(pop)ë˜ëŠ” ë°©ì‹ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì „ì—­ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸**(Global Execution Context): GECëŠ” JS ì½”ë“œê°€ ì‹¤í–‰ì„ ì‹œì‘í•  ë•Œ ìƒê¸°ëŠ” ê¸°ë³¸ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì…ë‹ˆë‹¤. ì´ê²ƒì„ í†µí•´ `window` ê°ì²´ì™€ `this` í‚¤ì›Œë“œë¥¼ ë§Œë“¤ê³  ë°”ì¸ë”©í•©ë‹ˆë‹¤.

GECëŠ” ì‹¤í–‰ì´ ì¢…ë£Œë˜ë©´ í˜¸ì¶œ ìŠ¤íƒì—ì„œ ì œê±°ë˜ê³  ECMAScript ì½”ë“œê°€ ì‹¤í–‰ë˜ê¸° ì „ ë‹¤ì‹œ ìƒì„±ë©ë‹ˆë‹¤.
([ECMA ëª…ì„¸](https://lightmap.dev/how-does-javascript-even-work-1)ì—ì„œ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì— ëŒ€í•´ í™•ì¸í•´ë³´ì„¸ìš”!)

# ì‹±ê¸€ ìŠ¤ë ˆë“œë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ë¬¸ì œ

## í˜¸ì¶œ ìŠ¤íƒ í­íŒŒì‹œí‚¤ê¸°

ì˜ˆì™¸ê°€ ë°œìƒí–ˆì„ ë•Œ ì½˜ì†”ì— ë‚˜íƒ€ë‚˜ëŠ” ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤(Stack Trace)ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê¸° ì „ê¹Œì§€ì˜ ìŠ¤íƒë“¤ì„ ê¼¬ë¦¬ë¥¼ ë¬¼ë©° ìŠ¤íƒì„ í‘œì‹œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

```jsx
// foo.js

function foo() {
  throw new Error('SessionStack will help you resolve crashes :)');
}
function bar() {
  foo();
}
function start() {
  bar();
}
start();
```

ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ìŠ¤íƒì˜ ê¼¬ë¦¬ë¥¼ ë¬¼ë©° ì—ëŸ¬ê°€ ë°œìƒë©ë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/e3055921-7ae9-4fac-a31b-2894fa07baee/image.png)

í˜¸ì¶œ ìŠ¤íƒì˜ ìµœëŒ€ì¹˜ê°€ ë˜ë©´ â€œ**ìŠ¤íƒ í­íŒŒì‹œí‚¤ê¸°**(Blowing the stack)â€ê°€ ì¼ì–´ë‚©ë‹ˆë‹¤.
íŠ¹íˆ ì½”ë“œë¥¼ ê´‘ë²”ìœ„í•˜ê²Œ í…ŒìŠ¤íŠ¸í•˜ì§€ ì•Šê³  ì¬ê·€ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì— ë§¤ìš° ì‰½ê²Œ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
function foo() {
  foo();
}
foo();
```

ì—”ì§„ì´ ì´ ì½”ë“œë¥¼ ì‹¤í–‰í•  ë•Œ, í•¨ìˆ˜ì¸ fooë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.

ì—¬ê¸°ì„œëŠ” foo í•¨ìˆ˜ê°€ ë°˜ë³µì ìœ¼ë¡œ ìê¸° ìì‹ ì„ í˜¸ì¶œí•˜ëŠ” ì¬ê·€ í˜¸ì¶œì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
ê·¸ëŸ¬ë©´ í˜¸ì¶œ ìŠ¤íƒì— ë˜‘ê°™ì€ í•¨ìˆ˜ê°€ ê³„ì† ìŒ“ì´ê²Œ ë©ë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/09b8e8fb-bcee-437c-9818-d60b63e935f0/image.png)

ì´ë ‡ê²Œ ì‹¤í–‰ì„ í•˜ê²Œ ë˜ë©´ ì–´ë–¤ ì‹œì ì— í˜¸ì¶œ ìŠ¤íƒì˜ ìµœëŒ€ì¹˜ë¥¼ ë„˜ì–´ í•¨ìˆ˜ í˜¸ì¶œì„ í•˜ê²Œ ë©ë‹ˆë‹¤.
ê·¸ëŸ¬ë©´ ë¸Œë¼ìš°ì €ê°€ ì´ëŸ° ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/eb7f7e85-d122-480d-a51b-f574c0667bbf/image.png)

ì‹±ê¸€ ìŠ¤ë ˆë“œ ê¸°ë°˜ì€ ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ì¼ì–´ë‚˜ëŠ” ë°ë“œë½(deadlocks) ê°™ì€ ë³µì¡í•œ ë¬¸ì œë“¤ì„ ì²˜ë¦¬í•  í•„ìš”ê°€ ì—†ê¸°ì— êµ‰ì¥íˆ ì‰½ìŠµë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/db1bb732-3a6c-4a3c-ad02-0206817d4ea8/image.png)

**ì¶œì²˜**: [https://m.blog.naver.com/smc503/221920305642](https://m.blog.naver.com/smc503/221920305642)

ê·¸ëŸ¬ë‚˜ ì‹±ê¸€ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰í•˜ëŠ” ê²ƒì€ êµ‰ì¥íˆ ì œí•œì ì…ë‹ˆë‹¤.
í•œ ê°œì˜ í˜¸ì¶œ ìŠ¤íƒì´ ê°€ì§€ê³  ìˆëŠ” JavaScriptì—ì„œëŠ” ì‘ì—…ì´ ëŠë ¤ì§€ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”?

## ë©”ì¸ ìŠ¤ë ˆë“œ ì°¨ë‹¨í•˜ê¸°

ë§Œì•½ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ì— ë¬´í•œ ë£¨í”„ê°€ ë°œìƒí•˜ë©´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤!

```jsx
// ì´ í•¨ìˆ˜ê°€ ë²„íŠ¼ í´ë¦­ ì‹œ ë¬´í•œ ë£¨í”„ë¥¼ ë„ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
function blockMainThread() {
  while (true);
}

//ë©”ì¸ ìŠ¤ë ˆë“œ ë²„íŠ¼ì— ì´ë²¤íŠ¸ë¥¼ ì£¼ì…í•©ë‹ˆë‹¤.
const btn = document.getElementById('block');
btn.addEventListener('click', blockEventLoop);
```

ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ blockMainThread() í•¨ìˆ˜ì˜ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ í˜¸ì¶œ ìŠ¤íƒìœ¼ë¡œ í‘¸ì‹œë˜ê³  ë¬´í•œ ë£¨í”„ë¡œ ì¸í•´ ê³„ì† ì‹¤í–‰í•˜ê²Œ ë©ë‹ˆë‹¤. (GECëŠ” í•­ìƒ ì¡´ì¬í•©ë‹ˆë‹¤)

ì´ë¡œ ì¸í•´ ì‹±ê¸€ ìŠ¤ë ˆë“œëŠ” blockMainThread() í•¨ìˆ˜ë¥¼ ê³„ì† ì‹¤í–‰í•˜ê²Œ ë˜ë©° ì•„ë¬´ ê²ƒë„ ì²˜ë¦¬í•  ìˆ˜ ì—†ê¸°ì— ëª¨ë“  UI ì‘ë‹µì´ ì°¨ë‹¨ë©ë‹ˆë‹¤.

ë”°ë¼ì„œ ë²„íŠ¼ì´ í´ë¦­ë˜ë©´ íƒ­ì€ ì™„ì „íˆ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ì—†ëŠ” ìƒíƒœê°€ ë˜ë©° íƒ­ì—ì„œ ì•„ë¬´ê²ƒë„ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
â€™ìŠ¤ë ˆë“œë¥¼ ê°•ì œë¡œ ì¤‘ì§€í•˜ë¼â€™ëŠ” ì¤‘ì§€ í”„ë¡¬í”„íŠ¸ ì°½ì„ ë³´ê¸° ì „ê¹Œì§€ ë§ì´ì£ ..!

ì´ì œ ì €í¬ëŠ” ë¬¸ì œì— ëŒ€í•´ ì¸ì§€í•˜ì˜€ìŠµë‹ˆë‹¤.

ìš°ë¦¬ê°€ ì‹¤í–‰í•œ ì½”ë“œëŠ” ê·¹ë‹¨ì ìœ¼ë¡œ ì‘ì„±í•œ ì½”ë“œì§€ë§Œ ì–´ë–¤ í•¨ìˆ˜ì—ì„œ ì˜¤ëœ ì‹œê°„ì´ ì†Œìš”ë˜ê³  ë‹¤ë¥¸ ëª¨ë“  ì½”ë“œë¥¼ ì°¨ë‹¨í•˜ì—¬ ì˜¤ëœ ì‹œê°„ë™ì•ˆ í˜ì´ì§€ê°€ ì‘ë‹µí•˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê°œë°œìê°€ ì •í•œ ì‹œê°„ ì´í›„ì—ì•¼ ë¬´ì–¸ê°€ë¥¼ ì‹¤í–‰í•˜ê¸° ì›í•˜ëŠ” ê²½ìš°ë„ ìˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ì‹±ê¸€ ìŠ¤ë ˆë“œë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì€ ì‚¬ìš©ìì˜ ê²½í—˜ì— êµ‰ì¥íˆ ì¢‹ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.

ì´ê²ƒì„ Web APIs, ì´ë²¤íŠ¸ ë£¨í”„(event loop), ì—¬ëŸ¬ ê°œì˜ Queueë¥¼ ì‚¬ìš©í•˜ì—¬ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë‹¨ì¼ ìŠ¤ë ˆë“œ ë¬¸ì œë¥¼ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.

# ë¬¸ì œ í•´ê²°

## Web APIs

ê¸°ë³¸ì ìœ¼ë¡œ ë¸Œë¼ìš°ì €ì— ì˜í•´ ìš°ë¦¬ì—ê²Œ ë…¸ì¶œë˜ëŠ” ìˆ˜ë§ì€ ê°•ë ¥í•œ ê¸°ëŠ¥ê³¼ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì´ì•¼ê¸°í•©ë‹ˆë‹¤.
Web APIsëŠ” ë” ë¹ ë¥¸ ì–¸ì–´(ex: í¬ë¡¬ì˜ C++)ë¡œ êµ¬í˜„ë˜ì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ ìë°”ìŠ¤í¬ë¦½íŠ¸ì™€ í•¨ê»˜ ì‚¬ìš©ë©ë‹ˆë‹¤.

1. ë„¤íŠ¸ì›Œí¬ ìš”ì²­
2. DOM ì¡°ì‘
3. Local Storage
4. ë¸”ë£¨íˆ¬ìŠ¤
5. í™”ë©´ ìº¡ì²˜
6. ìœ„ì¹˜
7. setTimeout, íƒ€ì´ë¨¸

ë“±ë“±â€¦ ì €í¬ê°€ ìì£¼ ì‚¬ìš©í•˜ëŠ” console.logë„ ì½˜ì†” Web APIì˜ ì¼ë¶€ì…ë‹ˆë‹¤.

ìì„¸í•œ ë‚´ìš©ì€ [Web APIs ë¬¸ì„œ](https://developer.mozilla.org/en-US/docs/Web/API)ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!

> ì²˜ìŒ ì½ëŠ” ê°œë°œìì—ê² ë§ˆìŒì´ ì•„í”Œ ìˆ˜ ìˆëŠ” ë‚´ìš©ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤â€¦(?)
> ëª¨ë“  fetch, setTimeout, console.logëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ì•„ë‹ˆë©° ë¸Œë¼ìš°ì €ì—ì„œ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

Web APIì˜ íŠ¹ì§•ì€ ë¸Œë¼ìš°ì €ì— ì˜í•´ íš¨ê³¼ì ìœ¼ë¡œ ë‹¤ë¥¸ ìŠ¤ë ˆë“œë¡œ ì‹¤í–‰ë˜ê³  íƒ­ì˜ ê¸°ë³¸ ìë°”ìŠ¤í¬ë¦½íŠ¸ ìŠ¤ë ˆë“œë¥¼ ë°©í•´í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê·¸ë ‡ë‹¤ë©´ Web APIì¸ console.logë„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë ê¹Œìš”?

ë„¤! ë‹¤ë¥¸ ì£¼ìš” ë¸Œë¼ìš°ì €ì—ì„œë„ console.logëŠ” ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ console.logëŠ” ì½œë°±ì„ í¬í•¨í•˜ì§€ ì•Šê¸°ì— ë¸Œë¼ìš°ì €ì—ê²Œ í•  ì¼ì„ ë„˜ê¸´ í›„ ë¸Œë¼ìš°ì €ê°€ ì½˜ì†”ì„ ì¶œë ¥í•œ ë’¤ ë‹¤ì‹œ JS ì—”ì§„ìœ¼ë¡œ ëŒì•„ì˜¤ì§„ ì•ŠìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ë¹„ë™ê¸° íŠ¹ì„±ì„ ê´€ì°°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

ê²°ë¡ ì ìœ¼ë¡œ ëª¨ë“  Web APIëŠ” ë©”ì¸ ìŠ¤ë ˆë“œë¥¼ ì°¨ë‹¨í•˜ì§€ ì•Šê³  ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ì„œ íš¨ê³¼ì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©° JS ì—”ì§„ì—ì„œ ëª¨ë“  ëŠë¦° ì‘ì—…ë“¤ì„ ë„˜ê¹ë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/55354166-9f17-4513-87d8-7150c57fa6a5/image.png)

**ì¶œì²˜**: [https://lightmap.dev/how-does-javascript-even-work-1](https://lightmap.dev/how-does-javascript-even-work-1)

> ë¸Œë¼ìš°ì €ëŠ” GECì— ì˜í•´ ìƒì„±ëœ ì „ì—­ ê°ì²´ì¸ window ê°ì²´ë¥¼ í†µí•´ JS ì—”ì§„ì´ ëª¨ë“  Web APIì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤.
> ì‹¤ì œë¡œ `window.setTimeout` ìœ¼ë¡œ Web APIì— ì ‘ê·¼í•´ì•¼ í•˜ì§€ë§Œ JSì—ì„œ ì´ëŸ° ì ‘ê·¼ ê¶Œí•œì„ ê°€ì§€ê³  ìˆê¸°ì— ì ‘ê·¼í•˜ê¸° ìš©ì´í•˜ë„ë¡ í•´ì¤ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ Web APIì—ì„œ ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œ, ë””ìŠ¤í¬ ì ‘ê·¼ ë“±ì˜ ì½œë°±ì„ ì „ë‹¬í•˜ëŠ” ê²ƒ ê°™ì€ ê²½ìš°ì— ë©”ì¸ ìŠ¤ë ˆë“œì™€ ì–´ë–»ê²Œ ì†Œí†µí•  ìˆ˜ ìˆì„ê¹Œìš”?

ì—¬ê¸°ì—ì„œ ë‹¤ì–‘í•œ íì™€ ì´ë²¤íŠ¸ ë£¨í”„ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.

## Queues

1. Task Queue (= Callback Queue)
2. Render Queue
3. Micro-Task Queue (= Job Queue)

ë¨¼ì € Task Queueì— ëŒ€í•´ ì´í•´í•˜ê³  Task Queueë¥¼ ì´ìš©í•˜ì—¬ ì´ë²¤íŠ¸ ë£¨í”„ë¥¼ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.
ê·¸ ì´í›„ ì „ì²´ ì‹œìŠ¤í…œì´ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ì•Œì•„ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤.

### Task Queue

Callback Queue, Message Queueë¼ê³ ë„ ë¶ˆë¦¬ëŠ” Task QueueëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì„ ì…ì„ ì¶œ(FIFO) ë°ì´í„° êµ¬ì¡°ì…ë‹ˆë‹¤. ([ìì„¸í•œ Queue ë°ì´í„° êµ¬ì¡°ëŠ” ì—¬ê¸°ì„œ í™•ì¸í•´ë³´ì„¸ìš”](https://www.geeksforgeeks.org/queue-data-structure/))

ë”°ë¼ì„œ Web APIê°€ ë¬´ê±°ìš´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³  ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹œê°„ì´ ê±¸ë¦¬ëŠ” ì‘ì—…ì„ ì‹¤í–‰í•˜ë©´ ì´ëŸ° ì‘ì—…ì˜ ì½œë°±ì„ Callback Queueë¼ê³  ë¶ˆë¦¬ëŠ” Task Queueì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/31ffadf1-0ef5-4b93-a59a-760049f339ff/image.png)

**ì¶œì²˜**: [https://lightmap.dev/how-does-javascript-even-work-1](https://lightmap.dev/how-does-javascript-even-work-1)

## Event Loop

![](https://velog.velcdn.com/images/reum107/post/fa0386b6-48f8-4089-8780-29309f344729/image.gif)

**ì¶œì²˜**: [http://latentflip.com/loupe](http://latentflip.com/loupe)

ëª¨ë“  JS ì½”ë“œê°€ ì‹¤í–‰ë˜ê³  í˜¸ì¶œ ìŠ¤íƒì´ ë¹ˆë‹¤ë©´ ì´ë²¤íŠ¸ ë£¨í”„ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.
ì´í›„ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” Task Queueì— ì§„í–‰í•  ì‘ì—…ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  í˜¸ì¶œ ìŠ¤íƒì— í‘¸ì‹œí•˜ì—¬ ì‹¤í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.

ìë°”ìŠ¤í¬ë¦½íŠ¸ í”„ë¡œê·¸ë¨ì€ ì•„ë˜ì™€ ê°™ì€ ìˆœì„œë¡œ ì§„í–‰ì´ ë˜ëŠ” ê²ƒì´ì£ !

1. í˜¸ì¶œ ìŠ¤íƒì´ Web API ê´€ë ¨ëœ ì‘ì—…ì„ ë§Œë‚˜ë©´ Web APIì—ê²Œ ë„ì›€ì„ ìš”ì²­í•©ë‹ˆë‹¤.
2. Web APIëŠ” í˜¸ì¶œ ìŠ¤íƒì— ì™„ë£Œë¡œ í‘œì‹œí•œ ë’¤ Web APIë¡œ í•´ë‹¹ ì‘ì—…ì„ ë„˜ê¹ë‹ˆë‹¤.
3. ë¸Œë¼ìš°ì €ëŠ” ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‘ì—…ì„ ì‹¤í–‰í•˜ê³  ì½œë°±ì„ Task Queue(Callback Queue)ë¡œ í‘¸ì‹œí•©ë‹ˆë‹¤.
4. ì¼ë°˜ ì½”ë“œ ì‹¤í–‰ì´ ì™„ë£Œëœ ë’¤ í˜¸ì¶œ ìŠ¤íƒì´ ë¹„ì–´ ìˆìœ¼ë©° GECë„ ì œê±°ë˜ë©´ ì´ë²¤íŠ¸ ë£¨í”„ê°€ ì¼ì„ ì‹œì‘í•©ë‹ˆë‹¤.
5. ì´ë²¤íŠ¸ ë£¨í”„ëŠ” Task Queueì˜ ì‘ì—…ì„ í™•ì¸í•˜ê³  ì‘ì—…ì„ í•˜ë‚˜ì”© Call Stackì— í‘¸ì‹œí•œ ë’¤ ì‹¤í–‰í•©ë‹ˆë‹¤.
6. GECëŠ” í•­ìƒ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œê°€ ì‹¤í–‰ë˜ê¸° ì „ì— ìƒì„±ë˜ë¯€ë¡œ ì´ë²¤íŠ¸ ë£¨í”„ê°€ ì‘ì—…ì„ í‘¸ì‹œí•  ë•Œë„ GECê°€ ìƒì„±ë©ë‹ˆë‹¤.

> **ì´ë²¤íŠ¸ ë£¨í”„**ëŠ” ì¼ë°˜ì ì¸ CS ìš©ì–´ì´ë©° í”„ë¡œê·¸ë¨ì—ì„œ ì´ë²¤íŠ¸ë‚˜ ë©”ì„¸ì§€ë¥¼ ê¸°ë‹¤ë¦¬ê³  ë””ìŠ¤íŒ¨ì¹˜í•˜ëŠ” í”„ë¡œê·¸ë˜ë° êµ¬ì¡° ë˜ëŠ” ë””ìì¸ íŒ¨í„´ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
> ì´ë²¤íŠ¸ ë£¨í”„ëŠ” Windows OS, GLib ë“± ë‹¤ì–‘í•œ ê³³ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ([Wikipedia](https://en.wikipedia.org/wiki/Event_loop))
> ì´ê²ƒì€ JSì—ë§Œ ìˆëŠ” ê°œë…ì€ ì•„ë‹ˆë©° êµ¬í˜„ì€ ì°¨ì´ê°€ ìˆê² ì§€ë§Œ ê°™ì€ ê°œë…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

# Chromeì˜ ì´ë²¤íŠ¸ ë£¨í”„

ì´ë²¤íŠ¸ ë£¨í”„ëŠ” V8ì˜ ì¼ë¶€ì¼ê¹Œìš”?
ã„´ ì•„ë‹™ë‹ˆë‹¤!!!!!!!!!!!!!!

![](https://velog.velcdn.com/images/reum107/post/03d364eb-f15f-4746-bffa-15f554075041/image.png)

**ì¶œì²˜**: [https://lightmap.dev/how-does-javascript-even-work-1](https://lightmap.dev/how-does-javascript-even-work-1)

ì´ë²¤íŠ¸ ë£¨í”„ê°€ V8ì˜ ì¼ë¶€ê°€ ì•„ë‹ˆë¼ë©´ ì–´ë–»ê²Œ ì´ë²¤íŠ¸ ë£¨í”„ê°€ í˜¸ì¶œ ìŠ¤íƒì´ ë¹„ì—ˆëŠ”ì§€ íŒë‹¨í• ê¹Œìš”?

Chrome ë¸Œë¼ìš°ì €ì—ì„œ V8ì€ ë§¤ìš° ì¸ê¸°ìˆëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ì¸ ì´ë²¤íŠ¸ ì•Œë¦¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ libeventì™€ í•¨ê»˜ ì œê³µë˜ì–´ Chromeì— ì´ë²¤íŠ¸ ë£¨í”„ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

ë°˜ë©´ Nodeì—ì„œëŠ” ì´ë²¤íŠ¸ ë£¨í”„ ê¸°ëŠ¥ì„ ìœ„í•´ V8ê³¼ í•¨ê»˜ libUVë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

ì„œë²„ ì¸¡ ì‹¤í–‰ì„ ìš©ì´í•˜ê²Œ í•˜ê¸° ìœ„í•´ ë…¸ë“œì—ì„œ ì•½ê°„ ë‹¤ë¥¸ ì´ë²¤íŠ¸ ë£¨í”„ êµ¬í˜„ì´ í•„ìš”í•˜ê¸°ì— Chrome ë¸Œë¼ìš°ì €ì˜ ì´ë²¤íŠ¸ ë£¨í”„ì™€ëŠ” ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

## ì´ë²¤íŠ¸ ë£¨í”„ ì´í•´í•˜ê¸°

### ë¬´í•œ ì¬ê·€ ìƒí™©

í˜¸ì¶œ ìŠ¤íƒì„ í­íŒŒí–ˆë˜ í”„ë¡œê·¸ë¨ì„ ê¸°ì–µí•˜ì‹œë‚˜ìš”?
ì´ì œ ì•„ë¬´ ë¬¸ì œ ì—†ì´ ì‘ë™í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì•½ê°„ì˜ ë³€ê²½ì„ í†µí•´ ì‘ì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.

```jsx
function foo(i) {
  console.log(i);
  setTimeout(() => foo(i + 1), 0);
}

const btn = document.getElementById('foo');
btn.addEventListener('click', () => foo(0), false);
```

setTimeoutì— ì‘ì„±ëœ ì§€ì—° ì‹œê°„ì´ 0ì´ë¼ê³  ëª…ì‹œë˜ì–´ ìˆìŠµë‹ˆë‹¤.
ê·¸ ì™¸ëŠ” í­ë°œí–ˆë˜ í”„ë¡œê·¸ë¨ê³¼ ë™ì¼í•œ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. ì‘ë™ë°©ì‹ì„ ì´í•´í•´ë´…ì‹œë‹¤!

1. GECê°€ ìƒì„±ë˜ì–´ í˜¸ì¶œ ìŠ¤íƒì— ì¶”ê°€ë©ë‹ˆë‹¤.
2. ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
3. foo() í•¨ìˆ˜ ì»¨í…ìŠ¤íŠ¸ê°€ í˜¸ì¶œ ìŠ¤íƒì— ì¶”ê°€ë©ë‹ˆë‹¤.
4. foo()ê°€ ì‹¤í–‰ë˜ê³  ì²« ë²ˆì§¸ í˜¸ì¶œì—ì„œ iê°’ì„ 0ìœ¼ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤.
5. Web APIì¸ setTimeoutì„ ë§Œë‚˜ë©´ í˜¸ì¶œ ìŠ¤íƒì—ì„œ Web API ìª½ì¸ ë¸Œë¼ìš°ì €ì—ê²Œ ì‘ì—…ì„ ë„˜ê¹ë‹ˆë‹¤.
6. foo() í•¨ìˆ˜ì˜ ë§ˆì§€ë§‰ì— ë„ë‹¬í•˜ì—¬ foo() ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ì‚¬ë¼ì§€ì§€ë§Œ ì—¬ì „íˆ setTimeoutì´ ì‹¤í–‰ë˜ì§€ ì•Šì•„ í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
7. ì§€ì—° ì‹œê°„ì´ 0ì´ê¸°ì— setTimeoutì˜ ì½œë°±ì´ Task Queueì—ê²Œ ì „ë‹¬ë©ë‹ˆë‹¤.
8. foo(i+1)ì¸ Task Queueì˜ í•¨ìˆ˜ëŠ” ì´ë²¤íŠ¸ ë£¨í”„ì— ì˜í•´ ë¹ˆ í˜¸ì¶œ ìŠ¤íƒìœ¼ë¡œ í‘¸ì‹œë˜ê³  ì‹¤í–‰í•©ë‹ˆë‹¤.
9. 3ë‹¨ê³„ë¡œ ë‹¤ì‹œ ëŒì•„ê°€ ì‹¤í–‰í•©ë‹ˆë‹¤.

ìš”ì ì€ ê³„ì† ì‹¤í–‰í•˜ë©° í˜¸ì¶œ ìŠ¤íƒì„ ì±„ìš°ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.
ì´ê²ƒì€ ëª¨ë‘ ë¸Œë¼ìš°ì €ì—ì„œ ì œê³µí•˜ëŠ” setTimeout() API ë•ë¶„ì…ë‹ˆë‹¤â€¦!

### íƒ€ì„ì•„ì›ƒ ì •ë ¬(Timeout Sort!!!)

ë²„ë¸” ì •ë ¬, ì‚½ì… ì •ë ¬, ì„ íƒ ì •ë ¬ì— ëŒ€í•´ ë“¤ì–´ë³´ì…¨ê² ì§€ë§Œ íƒ€ì„ì•„ì›ƒ ì •ë ¬ì— ëŒ€í•´ ì•Œê³  ê³„ì‹ ê°€ìš”?

> ë‹¤ë¥¸ ì–¸ì–´ì—ì„  Sleep Sortë¼ê³  ë§ì´ ì´ì•¼ê¸°í•˜ëŠ” ë“¯ í•©ë‹ˆë‹¤!

setTimeout() APIë¥¼ ì´ìš©í•˜ì—¬ ìˆ«ìë¥¼ ì •ë ¬í•´ë³´ê² ìŠµë‹ˆë‹¤.

```jsx
let arr = [10, 100, 500, 20, 35];

arr.forEach((item) => {
  setTimeout(() => console.log(item), item);
});
```

1. í•­ìƒ GECê°€ ìƒì„±ë©ë‹ˆë‹¤.
2. ëª¨ë“  ë°°ì—´ ìš”ì†ŒëŠ” setTimeoutë¥¼ í˜¸ì¶œë˜ì–´ ìŠ¤íƒì— í‘¸ì‹œëœ í›„ ë¸Œë¼ìš°ì €ë¡œ ì˜¤í”„ë¡œë“œ ë©ë‹ˆë‹¤.(ë„˜ê¹ë‹ˆë‹¤.)
3. setTimeoutì€ ë°°ì—´ì— ì •ì˜ëœ ìˆ«ìë§Œí¼ ì§€ì—°ë©ë‹ˆë‹¤.
4. ê°€ì¥ ì§§ì€ 10msê°€ ëë‚˜ë©´ Task Queueë¡œ í‘¸ì‹œë˜ê³  ì´ë²¤íŠ¸ ë£¨í”„ë¡œ ì¸í•´ ì½œ ìŠ¤íƒìœ¼ë¡œ í‘¸ì‹œë˜ê³  10ì´ ê¸°ë¡ë©ë‹ˆë‹¤.
5. ì´í›„ 20, 35, 100, 500 ìˆœìœ¼ë¡œ ì¶œë ¥ë©ë‹ˆë‹¤.

ë©‹ì§€ì§€ ì•Šë‚˜ìš”?

# Render Queue

Render Queue(ì´í•˜ ë Œë” í)ëŠ” **ëª¨ë“  í™”ë©´ ì—…ë°ì´íŠ¸ í˜¹ì€ repaint(ì´í•˜ ë¦¬í˜ì¸íŠ¸) ì „ì— ìˆ˜í–‰í•´ì•¼ í•  ëª¨ë“  ì‘ì—…**ì„ ì²˜ë¦¬í•˜ëŠ” ì´ë²¤íŠ¸ ë£¨í”„ ì‹œìŠ¤í…œì˜ ë˜ ë‹¤ë¥¸ í ì…ë‹ˆë‹¤.

ë¸Œë¼ìš°ì €ê°€ ì •ê¸°ì ìœ¼ë¡œ ì´ëŸ° ë¦¬í˜ì¸íŠ¸ë¥¼ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì— ëª¨ë“  íš¨ê³¼ì™€ ì• ë‹ˆë©”ì´ì…˜ì´ ë°œìƒí•©ë‹ˆë‹¤.

ë¸Œë¼ìš°ì € ì‘ë™ ê³¼ì •ì„ ì´í•´í•˜ì‹  ë¶„ë“¤ì´ë¼ë©´ ë¦¬í˜ì¸íŠ¸ ë©”ì»¤ë‹ˆì¦˜ì´ ì–´ë–¤ ìˆœì„œë¡œ ë™ì‘í•˜ëŠ”ì§€ ì•„ì‹¤ê²ë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/8e98e8da-f113-4254-bed2-4f3f62d252c2/image.png)

ìœ„ì˜ ë‹¤ì´ì–´ê·¸ë¨ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‘ì—…(ë¦¬í˜ì¸íŠ¸ ì „ ì‘ì—…)ê³¼ ë¦¬í˜ì¸íŠ¸ì™€ ê´€ë ¨ëœ 4ê°€ì§€ ì£¼ìš” ë‹¨ê³„ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
ë” ìì„¸í•œ ë‚´ìš©ì€ [ë¸Œë¼ìš°ì € ë™ì‘ ê³¼ì •](https://velog.io/@reum107/how-browser-works) í˜¹ì€ â€œ[Browser Rendering Queue in-depth](https://frarizzi.science/journal/web-engineering/browser-rendering-queue-in-depth)â€ ê¸€ì„ í™•ì¸í•´ë³´ì„¸ìš”!

ë¸Œë¼ìš°ì €ëŠ” ë¦¬í˜ì¸íŠ¸ë¥¼ í•  ë•Œë§ˆë‹¤ ëª¨ë“  ë‹¨ê³„ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë©° ë³€ê²½ëœ ì‚¬í•­ì´ ìˆì„ ë•Œë§Œ ìˆ˜ì •í•©ë‹ˆë‹¤.

> **ë¸Œë¼ìš°ì €ëŠ” ì–´ë–¤ ì£¼ê¸°ë¡œ ë¦¬í˜ì¸íŠ¸ í• ê¹Œìš”?**
> ì£¼ìš” ë¸Œë¼ìš°ì €ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì´ˆë‹¹ 60íšŒë¡œ(= 60FPS) ë¦¬í˜ì¸íŠ¸ ì‘ì—…ì„ ì§„í–‰í•©ë‹ˆë‹¤.
> ëˆˆì´ ë” ë¹ ë¥¸ ë³€í™”ë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ê¸°ì— ì¼ë°˜ì ìœ¼ë¡œ 60FPSì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ë©”ì¸ ìŠ¤ë ˆë“œ(main thread)ê°€ ìœ íœ´ ìƒíƒœì´ê±°ë‚˜ í˜¸ì¶œ ìŠ¤íƒì´ ë¹„ì–´ ìˆì„ ë•Œë§Œ ì´ ì†ë„ë¡œ ë¦¬í˜ì¸íŠ¸í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.

ë”°ë¼ì„œ ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ì‘ì—…ì´ ìˆëŠ” ë™ì•ˆì—ëŠ” ë¦¬í˜ì¸íŠ¸ê°€ ë°œìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ê¸°ì— ì‘ì—…ì´ ëŒ€ê¸° ì¤‘ì¸ ê²½ìš° ë¸Œë¼ìš°ì €ëŠ” êµë¬˜í•˜ê²Œ ëª‡ ê°€ì§€ ì‘ì—…ì„ ì§„í–‰í•œ í›„ ë Œë”ë§ ì‘ì—…ì„ ì§„í–‰í•˜ê³  ë¹ ë¥´ê²Œ ë‹¤ì‹œ ëŒì•„ì˜¤ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.

ìœ„ì—ì„œ ì´ì•¼ê¸° í–ˆë˜ ë¬´í•œ ë£¨í”„ë¥¼ ì‹¤í–‰í•˜ì—¬ í˜¸ì¶œ ìŠ¤íƒì„ í­íŒŒì‹œì¼°ë˜ ì˜ˆì œì™€ setTimeoutì„ í†µí•´ ë¬¸ì œë¥¼ í•´ê²°í–ˆë˜ ì˜ˆì œë¥¼ ê¸°ì–µí•˜ì‹œë‚˜ìš”?

setTimeoutì„ ì´ìš©í•˜ë©´ í•´ë‹¹ ë¶€ë¶„ì€ í˜¸ì¶œ ìŠ¤íƒì´ ë¹„ì–´ìˆëŠ” ìƒí™©ì´ ìˆê¸°ì— ë Œë” ì‘ì—…ì´ ë“¤ì–´ì˜¬ ê¸°íšŒê°€ ìƒê²¨ ë¬¸ì œê°€ í•´ê²°ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.

[latentflip.com/loupe](https://lightmap.dev/latentflip.com/loupe) ì‚¬ì´íŠ¸ë¥¼ ì‚¬ìš©í•´ ë Œë” íë¥¼ ì§ì ‘ í™”ë©´ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ëŒì•„ê°€ì„œ ë¦¬í˜ì¸íŠ¸ ì „ì— ì‘ì—…ì„ ì–´ë–»ê²Œ Queue(ì´í•˜ í)ì— ë„£ì„ ìˆ˜ ìˆì„ê¹Œìš”?

ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œëŠ” ë Œë”ë§ íì— ì‘ì—…ì„ ì •ë ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë˜í•œ ë¸Œë¼ìš°ì €ì˜ ë©”ì„œë“œ(Web API) [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ëŸ° ì‘ì—…ì„ ì •ë ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> requestAnimationFrameì€ ì£¼ìš” ë¸Œë¼ìš°ì €ì—ì„  í˜ì¸íŠ¸ ì „ì— ì‘ì—…ì„ ì •ë ¬í•˜ì§€ë§Œ ëª¨ë“  ë Œë”ë§ ë‹¨ê³„ ì´í›„ ì‘ì—…ì„ ì •ë ¬í•˜ëŠ” ì‚¬íŒŒë¦¬ëŠ” ë‹¤ë¦…ë‹ˆë‹¤.
>
> ì¦‰, ë‹¤ìŒ ë Œë”ë§ ì¤‘ì— ì‘ì—…ì´ ì‹¤í–‰ë˜ê²Œ ë©ë‹ˆë‹¤.

ë Œë” íì—ëŠ” ì‹¤í–‰ ì¤‘ì— ë¬´ì–¸ê°€ë¥¼ ì¶”ê°€í•  ê²½ìš° ë‹¤ìŒ í˜ì¸íŠ¸ ì£¼ê¸°ì— ì²˜ë¦¬ë˜ë„ë¡ í•˜ëŠ” ì†ì„±ì´ ìˆìŠµë‹ˆë‹¤.

ì§€ê¸ˆê¹Œì§€ëŠ” Microtask Queue(ì´í•˜ ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ í)ì— ë“¤ì–´ê°€ê¸° ì „ ë Œë”ë§ íì™€ ì´ë²¤íŠ¸ ë£¨í”„ì™€ í˜¸ì¶œ ìŠ¤íƒê³¼ í•¨ê»˜ ì‘ë™í•˜ëŠ” íì— ëŒ€í•´ ì´ì•¼ê¸°í•˜ì˜€ìŠµë‹ˆë‹¤.

ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ì„  ES6ì—ì„œ ìƒˆë¡­ê²Œ ìƒê¸´ ê°œë…, Promiseì— ëŒ€í•´ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.

# Promises

ì´ì „ ê¸€ì—ì„œ ì‹œê°„ì„ ì§€ì—°í•˜ëŠ” ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©´ ì½œë°±ìœ¼ë¡œ ì „ë‹¬í–ˆìŠµë‹ˆë‹¤.
ê·¸ëŸ¬ë‚˜ ì½œë°± ì•ˆì— ì½œë°±ì´ ìˆê³  ê·¸ ì•ˆì— ë‹¤ì‹œ ì½œë°±ì´ ìˆë‹¤ë©´ ì½œë°± ì§€ì˜¥(**callback hell**)ì— ë¹ ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/e00deb76-2d30-4dff-b149-1fb1db503684/image.png)

**ì¶œì²˜**: [https://dev.to/jerrycode06/callback-hell-and-how-to-rescue-it-ggj](https://dev.to/jerrycode06/callback-hell-and-how-to-rescue-it-ggj)

ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ Promiseê°€ ES6ì—ì„œ ë“±ì¥í•˜ì˜€ìŠµë‹ˆë‹¤.

Promiseì—ëŠ” 3ê°€ì§€ ìƒíƒœê°€ ìˆìŠµë‹ˆë‹¤.

1. **Resolved**, ì‘ì—…ì´ ì™„ë£Œëœ ìƒíƒœë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
2. **Rejected**, ì‘ì—…ì— ë¬¸ì œê°€ ë°œìƒí•œ ìƒíƒœë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
3. **Pending**, ì‘ì—…ì´ ì§„í–‰ë˜ê³  ìˆëŠ” ìƒíƒœë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.

```jsx
const p = new Promise((resolve, reject) => {
  const a = 1;
  if (!a) {
    reject(new Error('This Promise is Rejected'));
  } else {
    resolve('This Promise is resolved');
  }
});

p.then(() => {
  console.log('Successfully Resolved');
}).catch(() => {
  console.log('Rejected');
});
```

ì½”ë“œë¥¼ í†µí•´ PromiseëŠ” Rejectì™€ Resolveë¼ëŠ” ìƒíƒœë¡œ ë¶„ê¸° ì²˜ë¦¬ë¥¼ í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©´ Resolveë¥¼, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ Rejectë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.

Promiseì— `.then()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ promiseê°€ resolve ìƒíƒœì¼ ë•Œ í•´ë‹¹ ë©”ì„œë“œ ì•ˆì— ìˆëŠ” ì½œë°±ì„ ì‹¤í–‰í•˜ê²Œ ë©ë‹ˆë‹¤. ë°˜ë©´ `.catch()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ promiseê°€ reject ìƒíƒœì¼ ë•Œ ê±°ë¶€ ì½œë°±ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.

`.finally()` ëŠ” Promiseì˜ ìƒíƒœ ê°’ì´ í™•ì •ëœ ë’¤ ì‹¤í–‰ë˜ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤.

PromiseëŠ” Promise Chaniningì´ë¼ëŠ” ê²ƒì„ ì´ìš©í•´ ì½œë°± ì§€ì˜¥ì„ í•´ê²°í•˜ê³  async/awaitë¥¼ ì´ìš©í•˜ì—¬ ë¹„ë™ê¸° í•¨ìˆ˜ì—ì„œ Promiseë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì§€ê¸ˆì€ JS ë™ì‘ ë°©ì‹ì— ì§‘ì¤‘í•˜ì—¬ Promiseì™€ .then(), .catch() ì½œë°±ì„ ì²˜ë¦¬í•˜ëŠ” Queueì— ëŒ€í•´ ì´í•´í•´ë´…ì‹œë‹¤!

# MicroTask Queue

Microtask Queue(= Job Queue, ì´í•˜ ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ í)ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Promiseë¥¼ ì²˜ë¦¬í•˜ëŠ” í¥ë¯¸ë¡œìš´ Queueì…ë‹ˆë‹¤.

ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íëŠ” íƒœìŠ¤í¬ íì™€ ë Œë”ë§ íë³´ë‹¤ ìš°ì„  ìˆœìœ„ê°€ ë†’ìŠµë‹ˆë‹¤.
ì¦‰, ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íì˜ ì‘ì—…ì´ ë¨¼ì € ì‹¤í–‰ë©ë‹ˆë‹¤.

í˜¸ì¶œ ìŠ¤íƒì´ ë¹„ê²Œë˜ë©´ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íì— ì‘ì—…ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ì‘ì—…ì´ ìˆë‹¤ë©´ í•´ë‹¹ ì‘ì—…ì„ ì™„ë£Œí•©ë‹ˆë‹¤.

ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íì˜ ìš°ì„  ìˆœìœ„ê°€ ê°€ì¥ ë†’ê¸°ì— ëª¨ë“  ì‘ì—…ì„ ì™„ë£Œí•  ë•Œê¹Œì§€ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íì˜ ì‘ì—…ì„ ì§„í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.

ì´ ë™ì‘ìœ¼ë¡œ ì¸í•´ ë¬´í•œ ë£¨í”„ì™€ ìœ ì‚¬í•œ ì½”ë“œê°€ ì‘ì„±ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
function blockEventLoop() {
  Promise.resolve().then(blockEventLoop);
}

const btn = document.getElementById('kill');
btn.addEventListener('click', blockEventLoop, false);
```

idê°€ killì¸ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ëª¨ë“  ì‘ì—…ì´ ì–¼ê²Œ ë©ë‹ˆë‹¤.
ì‘ë™ ìˆœì„œë¥¼ í†µí•´ ì´ìœ ë¥¼ ì•Œì•„ë´…ì‹œë‹¤.

1. ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ê³  btnì— click ì´ë²¤íŠ¸ê°€ ì¶”ê°€ë©ë‹ˆë‹¤.
2. idê°€ killì¸ ë²„íŠ¼ì„ ëˆ„ë¦…ë‹ˆë‹¤.
3. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ í˜¸ì¶œë˜ê³  íì— `blockEventLoop` í•¨ìˆ˜ê°€ ì¶”ê°€ë©ë‹ˆë‹¤.
4. í˜¸ì¶œ ìŠ¤íƒì€ ë¹„ì–´ìˆëŠ” ìƒíƒœì´ë¯€ë¡œ ì´ë²¤íŠ¸ ë£¨í”„ê°€ promiseë¥¼ í˜¸ì¶œ ìŠ¤íƒìœ¼ë¡œ ê°€ì ¸ì˜¤ê³  ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ promiseê°€ íì— ì¶”ê°€ë˜ëŠ” ì‘ì—…ì´ ë°˜ë³µë©ë‹ˆë‹¤.
5. ê·¸ë ‡ê¸°ì— ë©”ì¸ ìŠ¤ë ˆë“œëŠ” ì‰¬ì§€ ì•Šê³  ì¼í•˜ë©° ì´ë¡œ ì¸í•´ ì •ì§€ëœ í™”ë©´ìœ¼ë¡œ ë³´ì´ê²Œ ë©ë‹ˆë‹¤.

ë‹¤ë¥¸ ì˜ˆì‹œë¥¼ í•˜ë‚˜ ë” í™•ì¸í•´ë´…ì‹œë‹¤! (ì¶œì²˜: JSConf)

```jsx
const button = document.getElementById('run');

button.addEventListener('click', () => {
  Promise.resolve().then(() => {
    console.log('MicroTask 1');
  });
  console.log('Listener 1');
});
button.addEventListener('click', () => {
  Promise.resolve().then(() => {
    console.log('MicroTask 2');
  });
  console.log('Listener 2');
});
```

- **ë²„íŠ¼ì„ í´ë¦­í•  ê²½ìš° ì½˜ì†” ì°½ì—ëŠ” ì–´ë–¤ ê²°ê³¼ê°€ ì¶œë ¥ë ê¹Œìš”?**
  Listener 1
  MicroTask 1
  Listener 2
  MicroTask 2

ì¶œë ¥ì´ ì§ê´€ì ì´ì§€ ì•Šìœ¼ë¯€ë¡œ ì‹¤í–‰ ìˆœì„œë¥¼ í™•ì¸í•´ë´…ì‹œë‹¤!

1. ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ê³  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ë²„íŠ¼ì— ì¶”ê°€ë©ë‹ˆë‹¤.
2. ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì²« ë²ˆì§¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ í˜¸ì¶œ ìŠ¤íƒì— ì¶”ê°€ë©ë‹ˆë‹¤.
3. Promiseê°€ resolveë˜ê³  ì½œë°±ì´ ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤. ê·¸ ì´í›„ `Listener 1` ì´ ì¶œë ¥ë©ë‹ˆë‹¤.
4. ì²« ë²ˆì§¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ í˜¸ì¶œ ìŠ¤íƒì—ì„œ ì œê±°ë˜ê³  í˜¸ì¶œ ìŠ¤íƒì´ ë¹„ê²Œ ë©ë‹ˆë‹¤.
   ê·¸ ì´í›„ ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ì˜ ì‘ì—…ì´ í˜¸ì¶œ ìŠ¤íƒìœ¼ë¡œ ë„˜ì–´ì™€ `MicroTask 1` ì´ ì¶œë ¥ë©ë‹ˆë‹¤.
5. ë‘ ë²ˆì§¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë„ ë™ì¼í•©ë‹ˆë‹¤.
6. ì‹¤í–‰ì´ ì¢…ë£Œë©ë‹ˆë‹¤.

ê·¸ë˜ì„œ JSì˜ ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?

1. [Promises](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)
2. [Mutation Observers](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)
3. [queueMicrotask()](https://developer.mozilla.org/en-US/docs/Web/API/queueMicrotask)

# Queue ì •ë¦¬í•˜ê¸°

- **Task Queue**
  - ì‘ì—…ì´ í•œ ë²ˆì— í•˜ë‚˜ì”© ì‹¤í–‰ë©ë‹ˆë‹¤.
  - ì´ë™ ì „ ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì–´ì•¼ í•œë‹¤ëŠ” ê·œì¹™ì€ ì—†ìŠµë‹ˆë‹¤.
- **Render Queue**
  - ì´ë²¤íŠ¸ ë£¨í”„ê°€ ë Œë” íì— ì˜¤ë©´ ì¡´ì¬í•˜ëŠ” ëª¨ë“  ì‘ì—…ì„ ì™„ë£Œí•˜ê³  ì´ë²¤íŠ¸ ë£¨í”„ê°€ ì‹œì‘ëœ í›„ ì‘ì—…ì´ ì¶”ê°€ë˜ë©´ í•´ë‹¹ ì‘ì—…ì€ ë‹¤ìŒ ì°¨ë¡€ë¡œ ë„˜ê¸°ê²Œ ë©ë‹ˆë‹¤.
- **Microtask Queue**
  - í•´ë‹¹ íëŠ” ëª¨ë“  ì‘ì—…ì´ ì—†ì–´ì§ˆ ë•Œê¹Œì§€ ì‹¤í–‰ë©ë‹ˆë‹¤.
    ê·¸ë ‡ê¸°ì— Promiseê°€ ë¬´í•œ ì¬ê·€ë¥¼ ì‹¤í–‰í•˜ë©´ ë©”ì¸ ìŠ¤ë ˆë“œê°€ ì°¨ë‹¨ë©ë‹ˆë‹¤.

# ëª¨ë“  Queueê°€ ì‚¬ìš©ë˜ëŠ” ì˜ˆì‹œ

```jsx
function log(arg) {
  console.log(arg);
}

// Function which will add a callback to task queue using setTimeout
function taskQueue(number, callback) {
  setTimeout(function () {
    callback(`Timeout ${number}`);
  }, 0);
}

// Function which will return a promise
function microTaskQueue(number) {
  return Promise.resolve(`Promise ${number}`);
}

// Pushing to microtask queue
microTaskQueue(1).then(log);
microTaskQueue(2).then(log);

// Pushing to task queue
taskQueue(1, log);

// Pushing to render queue
requestAnimationFrame(function () {
  log('RequestAnimationFrame 1');
});

//Normal code to show that the script will run till completion first
for (let i = 0; i < 100000000; i++) {}
console.log('The end');
```

ìˆœì„œë¥¼ ì´í•´í•´ë´…ì‹œë‹¤!

1. ë¨¼ì € `microTaskQueue(1).then(log)` / `microTaskQueue(2).then(log)` ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
   ë‘ log í•¨ìˆ˜ëŠ” ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íì— ë“¤ì–´ê°‘ë‹ˆë‹¤.
2. setTimeout APIë¥¼ í†µí•´ íƒœìŠ¤í¬ íì— log í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ëŠ” `taskQueue(1, log)` ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
3. ë Œë” íì— log í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ëŠ” `requestAnimationFrame()` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
4. forë¬¸ì´ ì‹¤í–‰ë˜ê³  `The end` ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.
5. ì´ì œ í˜¸ì¶œ ìŠ¤íƒì´ ë¹„ì—ˆìœ¼ë¯€ë¡œ ì´ë²¤íŠ¸ ë£¨í”„ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.
6. ì²« ë²ˆì§¸ëŠ” ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íê°€ ê°€ì¥ ìš°ì„  ìˆœìœ„ê°€ ë†’ìœ¼ë¯€ë¡œ ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íì˜ log í•¨ìˆ˜ë¥¼ í†µí•´ `Promise 1` , `Promise 2` ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.
7. ê·¸ ë‹¤ìŒ ë¸Œë¼ìš°ì €ê°€ ë Œë” íë¡œ ì´ë™í•˜ì—¬ `RequestAnimationFrame 1`ì´ ì¶œë ¥ë©ë‹ˆë‹¤.
8. ë§ˆì§€ë§‰ìœ¼ë¡œ íƒœìŠ¤í¬ íë¡œ ì´ë™í•˜ì—¬ `Timeout 1` ì´ ì¶œë ¥ë©ë‹ˆë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ ì´ë²¤íŠ¸ ë£¨í”„ë¥¼ ì½”ë“œë¡œ í‘œí˜„í•´ë³´ìë©´ ì•„ë˜ì™€ ë¹„ìŠ·í•  ê²ƒ ì…ë‹ˆë‹¤.

![](https://velog.velcdn.com/images/reum107/post/bdf0603a-d4f3-457b-a962-443623626ba6/image.png)

**ì¶œì²˜**: JSConf

# ì´ ì´ì•¼ê¸°ë¥¼ ë“£ê³  ë” ê¶ê¸ˆí•œ ì ì´ ìƒê²¼ë‹¤ë©´â€¦

[https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/](https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/)

ìœ„ ë¸”ë¡œê·¸ë¥¼ í™•ì¸í•˜ì—¬ íì˜ ë™ì‘ì´ ë¸Œë¼ìš°ì €ë§ˆë‹¤ ì–´ë–»ê²Œ ì°¨ì´ê°€ ìˆëŠ”ì§€ ì• ë‹ˆë©”ì´ì…˜ì„ í†µí•´ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

# ì°¸ê³  ìë£Œ

- [https://lightmap.dev/how-does-javascript-even-work-1](https://lightmap.dev/how-does-javascript-even-work-1)
- [https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf](https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf)
- [https://blog.sessionstack.com/how-javascript-works-inside-the-v8-engine-5-tips-on-how-to-write-optimized-code-ac089e62b12e](https://blog.sessionstack.com/how-javascript-works-inside-the-v8-engine-5-tips-on-how-to-write-optimized-code-ac089e62b12e)
- [https://joshua1988.github.io/web-development/translation/javascript/how-js-works-inside-engine/](https://joshua1988.github.io/web-development/translation/javascript/how-js-works-inside-engine/)
- [https://www.youtube.com/watch?v=8aGhZQkoFbQ](https://www.youtube.com/watch?v=8aGhZQkoFbQ)
- [https://lightmap.dev/how-does-javascript-even-work-part-2](https://lightmap.dev/how-does-javascript-even-work-part-2)
- [https://www.youtube.com/watch?v=8aGhZQkoFbQ](https://www.youtube.com/watch?v=8aGhZQkoFbQ)
- [https://www.youtube.com/watch?v=cCOL7MC4Pl0](https://www.youtube.com/watch?v=cCOL7MC4Pl0)
